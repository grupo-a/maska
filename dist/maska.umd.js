/*! maska v2.1.11 | (c) Alexander Shabunevich | Released under the MIT license */
(function(i,r){typeof exports=="object"&&typeof module!="undefined"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(i=typeof globalThis!="undefined"?globalThis:i||self,r(i.Maska={}))})(this,function(i){"use strict";var Z=Object.defineProperty;var O=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var V=(i,r,l)=>r in i?Z(i,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[r]=l,M=(i,r)=>{for(var l in r||(r={}))j.call(r,l)&&V(i,l,r[l]);if(O)for(var l of O(r))L.call(r,l)&&V(i,l,r[l]);return i};var J=(i,r)=>{var l={};for(var f in i)j.call(i,f)&&r.indexOf(f)<0&&(l[f]=i[f]);if(i!=null&&O)for(var f of O(i))r.indexOf(f)<0&&L.call(i,f)&&(l[f]=i[f]);return l};var y=(i,r,l)=>(V(i,typeof r!="symbol"?r+"":r,l),l);const r={"#":{pattern:/[0-9]/},"@":{pattern:/[a-zA-Z]/},"*":{pattern:/[a-zA-Z0-9]/}};class l{constructor(t={}){y(this,"opts",{});y(this,"memo",new Map);var e;const s=M({},t);if(s.tokens!=null){s.tokens=s.tokensReplace?M({},s.tokens):M(M({},r),s.tokens);for(const a of Object.values(s.tokens))typeof a.pattern=="string"&&(a.pattern=new RegExp(a.pattern))}else s.tokens=r;Array.isArray(s.mask)&&(s.mask.length>1?s.mask=[...s.mask].sort((a,o)=>a.length-o.length):s.mask=(e=s.mask[0])!=null?e:""),s.mask===""&&(s.mask=null),this.opts=s}masked(t){return this.process(t,this.findMask(t))}unmasked(t){return this.process(t,this.findMask(t),!1)}isEager(){return this.opts.eager===!0}isReversed(){return this.opts.reversed===!0}completed(t){const s=this.findMask(t);if(this.opts.mask==null||s==null)return!1;const e=this.process(t,s).length;return typeof this.opts.mask=="string"?e>=this.opts.mask.length:typeof this.opts.mask=="function"?e>=s.length:this.opts.mask.filter(a=>e>=a.length).length===this.opts.mask.length}findMask(t){var a,o;const s=this.opts.mask;if(s==null)return null;if(typeof s=="string")return s;if(typeof s=="function")return s(t);const e=this.process(t,(a=s.slice(-1).pop())!=null?a:"",!1);return(o=s.find(k=>this.process(t,k,!1).length>=e.length))!=null?o:""}escapeMask(t){const s=[],e=[];return t.split("").forEach((a,o)=>{a==="!"&&t[o-1]!=="!"?e.push(o-e.length):s.push(a)}),{mask:s.join(""),escaped:e}}process(t,s,e=!0){var P;if(s==null)return t;const a=`value=${t},mask=${s},masked=${e?1:0}`;if(this.memo.has(a))return this.memo.get(a);const{mask:o,escaped:k}=this.escapeMask(s),p=[],m=this.opts.tokens!=null?this.opts.tokens:{},h=this.isReversed()?-1:1,v=this.isReversed()?"unshift":"push",A=this.isReversed()?0:o.length-1,$=this.isReversed()?()=>c>-1&&d>-1:()=>c<o.length&&d<t.length,q=g=>!this.isReversed()&&g<=A||this.isReversed()&&g>=A;let S,E=-1,c=this.isReversed()?o.length-1:0,d=this.isReversed()?t.length-1:0;for(;$();){const g=o.charAt(c),u=m[g],R=(u==null?void 0:u.transform)!=null?u.transform(t.charAt(d)):t.charAt(d);if(!k.includes(c)&&u!=null){if(R.match(u.pattern)!=null)p[v](R),u.repeated?(E===-1?E=c:c===A&&c!==E&&(c=E-h),A===E&&(c-=h)):u.multiple&&(c-=h),c+=h;else if(u.multiple){const z=((P=p[d-h])==null?void 0:P.match(u.pattern))!=null,W=o.charAt(c+h);z&&W!==""&&m[W]==null?(c+=h,d-=h):p[v]("")}else R===S?S=void 0:u.optional&&(c+=h,d-=h);d+=h}else e&&!this.isEager()&&p[v](g),R===g&&!this.isEager()?d+=h:S=g,this.isEager()||(c+=h);if(this.isEager())for(;q(c)&&(m[o.charAt(c)]==null||k.includes(c));)e?p[v](o.charAt(c)):o.charAt(c)===t.charAt(d)&&(d+=h),c+=h}return this.memo.set(a,p.join("")),this.memo.get(a)}}const f=n=>JSON.parse(n.replaceAll("'",'"')),b=(n,t={})=>{const s=M({},t);return n.dataset.maska!=null&&n.dataset.maska!==""&&(s.mask=N(n.dataset.maska)),n.dataset.maskaEager!=null&&(s.eager=T(n.dataset.maskaEager)),n.dataset.maskaReversed!=null&&(s.reversed=T(n.dataset.maskaReversed)),n.dataset.maskaTokensReplace!=null&&(s.tokensReplace=T(n.dataset.maskaTokensReplace)),n.dataset.maskaTokens!=null&&(s.tokens=I(n.dataset.maskaTokens)),s},T=n=>n!==""?!!JSON.parse(n):!0,N=n=>n.startsWith("[")&&n.endsWith("]")?f(n):n,I=n=>{if(n.startsWith("{")&&n.endsWith("}"))return f(n);const t={};return n.split("|").forEach(s=>{const e=s.split(":");t[e[0]]={pattern:new RegExp(e[1]),optional:e[2]==="optional",multiple:e[2]==="multiple",repeated:e[2]==="repeated"}}),t};class C{constructor(t,s={}){y(this,"items",new Map);y(this,"beforeinputEvent",t=>{const s=t.target,e=this.items.get(s);e.isEager()&&"inputType"in t&&t.inputType.startsWith("delete")&&e.unmasked(s.value).length<=1&&this.setMaskedValue(s,"")});y(this,"inputEvent",t=>{if(t instanceof CustomEvent&&t.type==="input"&&t.detail!=null&&typeof t.detail=="object"&&"masked"in t.detail)return;const s=t.target,e=this.items.get(s),a=s.value,o=s.selectionStart,k=s.selectionEnd;let p=a;if(e.isEager()){const m=e.masked(a),h=e.unmasked(a);h===""&&"data"in t&&t.data!=null?p=t.data:h!==e.unmasked(m)&&(p=h)}if(this.setMaskedValue(s,p),"inputType"in t&&(t.inputType.startsWith("delete")||o!=null&&o<a.length))try{s.setSelectionRange(o,k)}catch(m){}});this.options=s,typeof t=="string"?this.init(Array.from(document.querySelectorAll(t)),this.getMaskOpts(s)):this.init("length"in t?Array.from(t):[t],this.getMaskOpts(s))}destroy(){for(const t of this.items.keys())t.removeEventListener("input",this.inputEvent),t.removeEventListener("beforeinput",this.beforeinputEvent);this.items.clear()}needUpdateOptions(t,s){const e=this.items.get(t),a=new l(b(t,this.getMaskOpts(s)));return JSON.stringify(e.opts)!==JSON.stringify(a.opts)}needUpdateValue(t){const s=t.dataset.maskaValue;return s==null&&t.value!==""||s!=null&&s!==t.value}getMaskOpts(t){const k=t,{onMaska:s,preProcess:e,postProcess:a}=k;return J(k,["onMaska","preProcess","postProcess"])}init(t,s){for(const e of t){const a=new l(b(e,s));this.items.set(e,a),e.value!==""&&this.setMaskedValue(e,e.value),e.addEventListener("input",this.inputEvent),e.addEventListener("beforeinput",this.beforeinputEvent)}}setMaskedValue(t,s){const e=this.items.get(t);this.options.preProcess!=null&&(s=this.options.preProcess(s));const a=e.masked(s),o=e.unmasked(e.isEager()?a:s),k=e.completed(s),p={masked:a,unmasked:o,completed:k};s=a,this.options.postProcess!=null&&(s=this.options.postProcess(s)),t.value=s,t.dataset.maskaValue=s,this.options.onMaska!=null&&(Array.isArray(this.options.onMaska)?this.options.onMaska.forEach(m=>m(p)):this.options.onMaska(p)),t.dispatchEvent(new CustomEvent("maska",{detail:p})),t.dispatchEvent(new CustomEvent("input",{detail:p}))}}const w=new WeakMap,U=n=>{setTimeout(()=>{var t;((t=w.get(n))==null?void 0:t.needUpdateValue(n))===!0&&n.dispatchEvent(new CustomEvent("input"))})},x=(n,t)=>{const s=n instanceof HTMLInputElement?n:n.querySelector("input"),e=M({},t.arg);if(s==null||(s==null?void 0:s.type)==="file")return;U(s);const a=w.get(s);if(a!=null){if(!a.needUpdateOptions(s,e))return;a.destroy()}if(t.value!=null){const o=t.value,k=p=>{o.masked=p.masked,o.unmasked=p.unmasked,o.completed=p.completed};e.onMaska=e.onMaska==null?k:Array.isArray(e.onMaska)?[...e.onMaska,k]:[e.onMaska,k]}w.set(s,new C(s,e))};i.Mask=l,i.MaskInput=C,i.tokens=r,i.vMaska=x,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
